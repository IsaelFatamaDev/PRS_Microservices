server:
  port: ${SERVER_PORT:8081}
  netty:
    connection-timeout: 10s
  http2:
    enabled: false
  compression:
    enabled: true
    min-response-size: 1024

spring:
  application:
    name: vg-ms-organizations
  profiles:
    active: ${SPRING_PROFILES_ACTIVE:prod}
  
  # Configuración de seguridad OAuth2/JWT
  security:
    oauth2:
      resourceserver:
        jwt:
          issuer-uri: ${JWT_ISSUER_URI}
          jwk-set-uri: ${JWT_JWK_SET_URI}
          # Cache reducido para ahorrar memoria
          cache:
            time-to-live: 60000
          # Configuración para producción - manejo de errores y timeouts
          # Si solo se proporciona issuer-uri, Spring Boot obtendrá automáticamente el jwk-set-uri
          # Si hay problemas de conectividad, descomentar para usar solo issuer-uri:
          # issuer-uri: ${JWT_ISSUER_URI:https://lab.vallegrande.edu.pe/jass/keycloak/realms/sistema-jass}

  # Configuración de base de datos MongoDB
  data:
    mongodb:
      uri: ${MONGODB_URI}
  
  main:
    lazy-initialization: true
  
  jmx:
    enabled: false
  
  output:
    ansi:
      enabled: never
  
  jackson:
    serialization:
      write-dates-as-timestamps: false
      indent-output: false
    deserialization:
      fail-on-unknown-properties: false
  
  codec:
    max-in-memory-size: 256KB

# Información de la aplicación
app:
  name: Microservicio de Organizaciones
  description: Microservicio para gestión de Organizaciones del Sistema JASS Digital
  version: 2.0.0
  organization: Valle Grande

# Configuración de Cloudinary
cloudinary:
  cloud-name: ${CLOUDINARY_CLOUD_NAME}
  api-key: ${CLOUDINARY_API_KEY}
  api-secret: ${CLOUDINARY_API_SECRET}

# Configuración de microservicios
microservices:
  users:
    name: ms-users
    base-url: ${MS_USERS_URL}
    endpoints:
      create-admin: /internal/organizations/{organizationId}/create-admin
      validate: /internal/users/validate
    timeout: 30

# Configuración de logging
logging:
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n"
    file: "%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n"
  level:
    root: ERROR
    pe.edu.vallegrande: INFO
    org.springframework.boot: WARN
    org.springframework.boot.web.embedded.netty: WARN
    org.springframework.security: DEBUG
    org.springframework.data.mongodb: WARN
    org.mongodb.driver: WARN
    reactor.netty: WARN
    io.netty: WARN
    com.mongodb: WARN
  file:
    path: ./logs
    name: vg-ms-organizations.log

# Configuración de monitoreo
management:
  endpoints:
    enabled-by-default: false
    web:
      exposure:
        include: health,info,metrics,prometheus
      base-path: /actuator
  endpoint:
    health:
      enabled: true
      show-details: always
      show-components: always
  health:
    defaults:
      enabled: false
    ping:
      enabled: true
    mongo:
      enabled: true
