# application-prod.yml - Configuración optimizada para Producción
server:
  port: ${SERVER_PORT}
  forward-headers-strategy: framework
  compression:
    enabled: true
    mime-types: application/json,application/xml,text/html,text/xml,text/plain
    min-response-size: 1024
  http2:
    enabled: true
  tomcat:
    threads:
      max: 20
      min-spare: 2
    max-connections: 50
    accept-count: 5
  netty:
    connection-timeout: 3000
    initial-buffer-size: 128
    max-initial-line-length: 4096

spring:
  application:
    name: vg-ms-water-quality
  main:
    lazy-initialization: false
    banner-mode: "off"  # Sin banner en producción
  jmx:
    enabled: false  # Deshabilitado para reducir overhead
  aop:
    auto: false
  data:
    mongodb:
      uri: ${MONGODB_URI}
  web:
    resources:
      cache:
        period: 86400  # Cache de 24 horas
  codec:
    max-in-memory-size: 512KB  # Limitado para optimizar memoria
  security:
    oauth2:
      resourceserver:
        jwt:
          issuer-uri: ${JWT_ISSUER_URI}
          jwk-set-uri: ${JWT_JWK_SET_URI}

# Swagger configurado para producción
springdoc:
  api-docs:
    path: /v3/api-docs
    enabled: true
  swagger-ui:
    path: /swagger-ui.html
    enabled: true
    tags-sorter: alpha
    operations-sorter: alpha

# Logging mínimo para producción
logging:
  level:
    root: WARN
    pe.edu.vallegrande: INFO
    org.springframework.web: WARN
    org.springframework.security: WARN
    org.springframework.data.mongodb: WARN
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"

info:
  app:
    name: Water Quality Microservice
    description: Microservicio para gestión de calidad de agua - Sistema JASS Digital
    version: 1.0.0
    environment: production

user-service:
  base-url: ${USER_SERVICE_URL}
  timeout: 3000

organization-service:
  base-url: ${ORGANIZATION_SERVICE_URL}
  token: ${ORGANIZATION_SERVICE_TOKEN}
  timeout: 3000

# Actuator endpoints limitados en producción
management:
  endpoints:
    web:
      exposure:
        include: health,info
  endpoint:
    health:
      show-details: when-authorized
